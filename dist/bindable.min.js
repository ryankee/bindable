/*! bindable - v0.1.0 - 2013-03-08
* https://github.com/ryankee/bindable
* Copyright (c) 2013 Ryan Kee; Licensed MIT */
(function(){this.Bindable={};var t=function(){var t=function(){};return t.create=function(t){var n=this,e=function(){function e(t,n,e){i[t]="function"!=typeof n||"function"!=typeof e?n:function(){return this._super=e,n.apply(this,arguments)}}this._super=n;var r=t.apply(this,arguments),i=this;for(var o in r)e(o,r[o],i[o])},r=this;return e.prototype=new r,e.prototype.constructor=e,e.extend=this.extend||this.create,e},t}(),n=t.create(function(){var t={};return t.id="bnd-p-"+Math.random().toString(36).substr(2,36),t.updateBindings=function(n){for(var e=t.getBindingsForID(t.id),r=0;e.length>r;r++)this.replaceBinding(e[r],t.id,n)},t.generateBinding=function(t,n){var e='<script data-binding-id="'+t+'-start"></script>',r='<script data-binding-id="'+t+'-end"></script>';return e+n+r},t.replaceBinding=function(t,n,e){var r="(<script.*"+n+'-start".*/script>).*?(<script.*'+n+'-end".*?/script>)',i=RegExp(r,"g"),o=t.innerHTML;t.innerHTML=o.replace(i,"$1"+e+"$2")},t.getBindingsForID=function(t){for(var n=[],e=document.getElementsByTagName("script"),r=0;e.length>r;r++)e[r].getAttribute("data-binding-id")===t+"-start"&&-1===n.indexOf(e[r].parentNode)&&n.push(e[r].parentNode);return n},t}),e=n.extend(function(t){this._super();var n,e=this;return e.set=function(t){if(!t)throw Error("Value cannot be empty");return n=t,e.updateBindings(n),e},e.get=function(){return n},e.bind=function(){return e.generateBinding(e.id,n)},e.set(t),e});Bindable.Property=function(){var t={};return t.create=function(t){if(!t)throw Error("Value cannot be empty");return new e(t)},t}();var r=n.extend(function(t){this._super();var n=this;return n.dependentKeys=[],n.cached=void 0,n.set=function(){throw Error("You cannot set computed properties directly. Use `get` and `set` on the properties instead.")},n.update=function(){n.updateBindings(n.get.call(this,!0))},n.get=function(e){return(e===!0||void 0===n.cached)&&(n.cached=t.call(this)),n.cached},n.bind=function(){return n.generateBinding(n.id,n.get.call(this))},n.property=function(){for(var t=0,e=arguments.length;e>t;t++)n.dependentKeys.push(arguments[t]);return n},n});Function.prototype.property=function(){var t=new r(this);return t.property.apply(t,arguments)},Bindable.Computed=function(){var t={};return t.create=function(t){if(!t)throw Error("Computed function cannot be empty");return new r(t)},t}();var i=t.create(function(t){var e={},r={},i={};r.set=function(t,o){if(!o)throw Error("Value cannot be empty");if(void 0!==e[t])e[t].set(o);else if(o instanceof n){e[t]=o;for(var a=0;o.dependentKeys.length>a;a++){var u=o.dependentKeys[a];void 0===i[u]&&(i[u]=[]),i[u].push(o)}}else e[t]=Bindable.Property.create(o);if(void 0!==i[t])for(var c in i[t])i[t][c].update.call(this);return r},r.get=function(t,n){if(void 0===e[t])throw Error("Property does not exist");return e[t].get.call(this,n)},r.bind=function(t){return e[t].bind.call(this)};for(var o in t)r.set(o,t[o]);return r});Bindable.Object=function(){var t={};return t.create=function(t){return new i(t)},t}()})();